install.packages("KoNLp")
install.packages("KoNLP")
install.packages("wordcloud2")
install.packages("tm")
getwd()
dataa <- file("rew.csv", encoding="UTF-8")
dataa
view(dataa)
dataaa <- readlines(dataa)
dataa <- read.csv("rew.csv")
dataa
useSejongDic()
install.packages("http://cran.r-project.org/bin/windows/contrib/3.0/tm_0.5-10.zip",repos=NULL)
useSejongDic()
library(KoNLP)
library(tm)
library(wordcloud2)
useSejongDic()
extractNoun(dataa)
dataa <- extractNoun(dataa)
dataa
data("airquality")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
head(airquality)
head(airquality, 10)
names(airquality)
names(airquality) <- tolower(names(airquality))
names(airquality)
aqm <- melt(airquality, id = c("month", "day"), na.rm = TRUE)
aqm
a <- cast(aqm, day ~ month ~ variable)
head(a, 20)
a
b <- cast(aqm, month ~ variable, mean)
b
c <- cast(aqm, month ~. |variable, mean)
c
d <- cast(aqm, month ~ variable, mean, margins = c("grand_row", "grand_col"))
d
e <- cast(aqm, month, variable, mean, subset=variable=="ozone")
e
e <- cast(aqm, month ~ variable, mean, subset=variable=="ozone")
e
dd <- cast(aqm, month ~ variable, mean, margins = c("grand_row"))
dd
ddd <- cast(aqm, month ~ variable, mean, margins = c("grand_col"))
ddd
f <- cast(aqm, month ~variable, range)
f
install.packages("sqldf")
library(sqldf)
data(iris)
sqldf("select * from iris")
sqldf("select * from iris libit 10")
sqldf("select * from iris limit 10")
sqldf("select count(*) from iris where Species like 'se%'")
set.seed(1)
d = data.frame(yeqr = rep(2012:2014, each = 6), count = round(runif(9, 0, 20))
print(d)
d = data.frame(yeqr = rep(2012:2014, each = 6), count = round(runif(9, 0, 20)))
print(d)
install.packages("plyr")
library(plyr)
data.frame(cv.count = cv)
ddply(d, "year", function(x) {
mean.count = mean(x$count)
sd.count = sd(x$count)
cv = sd.count/mean.count
data.frame(cv.count = cv)
})
ply(d, "year", function(x) {
mean.count = mean(x$count)
sd.count = sd(x$count)
cv = sd.count/mean.count
data.frame(cv.count = cv)
})
d = data.frame(year = rep(2012:2014, each = 6), count = round(runif(9, 0, 20)))
ddply(d, "year", function(x) {
mean.count = mean(x$count)
sd.count = sd(x$count)
cv = sd.count/mean.count
data.frame(cv.count = cv)
})
ddply(d, "year", summarise, mean.count = mean(count))
ddply(d, "year", transform, total.count = sum(count))
sessionInfo()
install.packages("installr")
library(instsallr)
library(installr)
updateR()
sessionInfo()
updateR()
source('~/.active-rstudio-document', echo=TRUE)
grup <- c(1,1,2,2)
df <- data.frame(df, grup)
df
df$grup1 <- c(1,1,2,2)
df
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup1 <- c(1,1,2,2)
df
apply(df, 2, mean)
apply(df, 1, mean)
df$mean <- apply(df, 1, mean)
df
df$mean <- apply(df, 1, mean(eng, math))
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c("1","1","2","2")
df$mean <- apply(df, 1, mean(eng, math))
df$mean <- apply(df, 1, mean)
df
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c("1","1","2","2")
df
dcast(df, grup ~eng+math, mean)
install.packages("reshape2")
library(reshape2)
dcast(df, grup ~eng+math, mean)
df
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
#install.packages("reshape2")
#library(reshape2)
dcast(df, grup ~eng+math, mean)
#install.packages("reshape2")
#library(reshape2)
dcast(df, grup ~eng, mean)
t(df)
t(df)
df <- t(df)
df
dcast(df, grup ~ , mean)
dcast(df, grup ~ ., mean)
dcast(df, grup ~ eng, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
dcast(df, grup ~ eng, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
dcast(df, eng+math ~ grup, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df$grup <- c(1,1,2,2)
df <- data.frame(eng, math)
dcast(df, grup ~ eng+math, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
dcast(df,  mean)
dcast(df, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
df
df$mean <- sapply(df[1:2, ], mean)
df$mean <- sapply(df[ ,1:2], mean)
df
df$mean2 <- apply(df[,1:2], 1, mean)
df
df$mean <- sapply(df[ ,1:2],1,  mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
df$mean <- apply(df[,1:2], 1, mean)
df
df$mean_g <- apply(df[ ,1:2], 1, mean, grouping(grup))
md <- melt(df, id=c("grup"))
md
md <- melt(df, id=c("grup"), mean)
md <- dcast(df, grup~eng, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
df$mean <- apply(df[,1:2], 1, mean)
md <- dcast(df, grup ~ eng, mean)
df
md <- dcast(df, eng ~ math, mean)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
md <- dcast(df, grup ~ eng, mean)
df
dd <- dcast(df, grup ~ eng, mean)
attach(df)
dd <- dcast(df, grup ~ eng, mean)
dd <- dcast(df, grup ~ eng)
library(reshape2)
attach(df)
dd <- dcast(df, grup ~ eng)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
df$mean <- apply(df[,1:2], 1, mean)
df
aggregate(d[ , 1:2], list(df$grup), mean)
aggregate(.~ grup, df[, 1:2], mean)
apply(df[, 1:2], 2, mean)
mean_g <- aggregate(.~grup, df[, 1:2], mean)
mean_g
df
install.packages("olsrr"); library(olsrr)
setwd("C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData")
data = read.csv("combine_seoul.csv", header = TRUE, na.strings = "", stringsAsFactors = FALSE)
idx <- c(3, 6:8, 10:15)
data <- data[ , idx]
idx_ctgry <- c(2:4)
data[idx_ctgry][!is.na(data[idx_ctgry])] <- 1
data[idx_ctgry][is.na(data[idx_ctgry])] <- 0
head(data)
# install.packages("olsrr"); library(olsrr)
attach(data)
ols_regress(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind)
ols_regress(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_regress(total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind ~ Personal.Illness, data = data)
model <- lm(total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind ~ Personal.Illness, data = data)
ols_step_both_p(model)
model <- lm(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(Personal.Illness + External.factors + Distress ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(External.factors~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(Distress ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(External.factors~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
model <- lm(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
ols_step_backward_aic(model)
ols_step_all_possible(model)
ols_step_backward_aic(model)
ols_step_forward_p(model)
ols_step_forward_aic(model)
ols_step_backward_aic(model)
ols_step_both_p(model)
ols_regress(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_regress(total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind ~ Personal.Illness, data = data)
model <- lm(External.factors~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
ols_step_both_p(model) #Humi, wind, snow, temp
ols_step_backward_aic(model) #x
ols_step_forward_aic(model)
model <- lm(Distress ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model)
ols_step_backward_aic(model) #Humi, rain
ols_step_forward_aic(model) #Humi, wind, snow, temp
ols_regress(Personal.Illness ~ total.dew + total.snow, data = data)
ols_regress(total.dew + total.snow ~ Personal.Illness, data = data)
ols_regress(Personal.Illness ~ total.dew, data = data)
ols_regress(Personal.Illness ~ total.snow, data = data)
ols_regress(Personal.Illness ~ total.dew, data = data)
ols_regress(Personal.Illness ~ total.dew + total.snow, data = data)
ancova(Personal.Illness ~ total.snow, data = data)
install.packages("HH"); library(HH)
ancova(Personal.Illness ~ total.snow, data = data)
eng <- c(60, 10, 70, 100)
math <- c(15, 70, 40, 80)
df <- data.frame(eng, math)
df$grup <- c(1,1,2,2)
df$mean <- apply(df[,1:2], 1, mean)
df
mean_g <- aggregate(.~grup, df[, 1:2], mean)
mean_g
ancova(Personal.Illness ~ total.snow + total.dew, data = data)
fit <- aov(Personal.Illness ~ total.snow + total.dew)
summary(fit)
fit <- aov(Personal.Illness ~ total.dew)
summary(fit) #dew만
plot(fit)
library(xlsx)
write.xlsx2(data, "SEOUL", sheetName="Sheet1",
col.names=TRUE, row.names=FALSE, append=FALSE, password=NULL, ...)
write.xlsx2(data, 'Seoul', sheetName="Sheet1",
col.names=TRUE, row.names=FALSE, append=FALSE, password=NULL, ...)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul.xlsx", sheetName="Sheet1",
col.names=TRUE, row.names=FALSE, append=FALSE, password=NULL, ...)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul.xlsx", sheetName="Sheet1",col.names=TRUE, row.names=FALSE, append=FALSE, password=NULL, ...)
setwd("C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData")
data = read.csv("combine_seoul.csv", header = TRUE, na.strings = "", stringsAsFactors = FALSE)
idx <- c(3, 6:8, 10:15)
data <- data[ , idx]
idx_ctgry <- c(2:4)
data[idx_ctgry][!is.na(data[idx_ctgry])] <- 1
data[idx_ctgry][is.na(data[idx_ctgry])] <- 0
head(data)
library(xlsx)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul.xlsx", sheetName="Sheet1",col.names=TRUE, row.names=FALSE)
write.csv(data, file = "seoul.csv")
write.csv(data, file = "seoul.csv", row.names = FALSE)
head(data)
data$rain_YN <- data$total.rain
head(data)
data$rain_YN <- replace(x, x>0, 1)
data$rain_YN <- replace(x, x==0, 1)
replace(x<-data$rain_YN, x>0, 1)
head(data)
data$snow_YN <- data$total.snow
data$snow_YN
replace(x<-data$snow_YN, x>0, 1)
library(xlsx)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul_temp2.xlsx", sheetName="Sheet1",col.names=TRUE, row.names=FALSE)
write.csv(data, file = "seoul_temp2.csv", row.names = FALSE)
data$rain_YN <-replace(x<-data$rain_YN, x>0, 1)
data$snow_YN <-replace(x<-data$snow_YN, x>0, 1)
setwd("C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData")
data = read.csv("combine_seoul.csv", header = TRUE, na.strings = "", stringsAsFactors = FALSE)
idx <- c(3, 6:8, 10:15)
data <- data[ , idx]
idx_ctgry <- c(2:4)
data[idx_ctgry][!is.na(data[idx_ctgry])] <- 1
data[idx_ctgry][is.na(data[idx_ctgry])] <- 0
head(data)
library(xlsx)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul.xlsx", sheetName="Sheet1",col.names=TRUE, row.names=FALSE)
write.csv(data, file = "seoul.csv", row.names = FALSE)
#wilcox.test
wilcox.test(total.Humi ~ Distress, data = data)
wilcox.test(total.temp ~ Distress, data = data)
wilcox.test(total.wind ~ Distress, data = data)
wilcox.test(total.rain ~ Distress, data = data)
wilcox.test(total.dew ~ Distress, data = data)
wilcox.test(total.snow ~ Distress, data = data)
wilcox.test(total.Humi ~ External.factors, data = data)
wilcox.test(total.temp ~ External.factors, data = data)
wilcox.test(total.wind ~ External.factors, data = data)
wilcox.test(total.rain ~ External.factors, data = data)
wilcox.test(total.dew ~ External.factors, data = data)
wilcox.test(total.snow ~ External.factors, data = data)
wilcox.test(total.Humi ~ Personal.Illness, data = data)
wilcox.test(total.temp ~ Personal.Illness, data = data)
wilcox.test(total.wind ~ Personal.Illness, data = data)
wilcox.test(total.rain ~ Personal.Illness, data = data)
wilcox.test(total.dew ~ Personal.Illness, data = data)
wilcox.test(total.snow ~ Personal.Illness, data = data)
#kruskal.test
kruskal.test(total.temp ~ Distress, data = data)
kruskal.test(total.wind ~ Distress, data = data)
kruskal.test(total.rain ~ Distress, data = data)
kruskal.test(total.dew ~ Distress, data = data)
kruskal.test(total.snow ~ Distress, data = data)
kruskal.test(total.temp ~ External.factors, data = data)
kruskal.test(total.wind ~ External.factors, data = data)
kruskal.test(total.rain ~ External.factors, data = data)
kruskal.test(total.dew ~ External.factors, data = data)
kruskal.test(total.snow ~ External.factors, data = data)
kruskal.test(total.temp ~ Personal.Illness, data = data)
kruskal.test(total.wind ~ Personal.Illness, data = data)
kruskal.test(total.rain ~ Personal.Illness, data = data)
kruskal.test(total.dew ~ Personal.Illness, data = data)
kruskal.test(total.snow ~ Personal.Illness, data = data)
# data$rain2 <- data$total.rain[] <- 1
# data$rain2 <- data$total.rain[] <- 1
# install.packages("olsrr"); library(olsrr)
attach(data)
ols_regress(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_regress(total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind ~ Personal.Illness, data = data)
model <- lm(Personal.Illness ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model) #dew
ols_step_backward_aic(model) #x
ols_step_forward_aic(model) #snow
ols_regress(Personal.Illness ~ total.dew + total.snow, data = data)
ols_regress(Personal.Illness ~ total.dew, data = data)
ols_regress(Personal.Illness ~ total.snow, data = data)
model <- lm(External.factors~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model) #Humi, wind, snow, temp
ols_step_backward_aic(model) #Humi, rain
ols_step_forward_aic(model) #Humi, wind, snow, temp
model <- lm(Distress ~ total.dew + total.Humi + total.rain + total.snow + total.temp + total.wind, data = data)
ols_step_both_p(model) #snow, wind
ols_step_backward_aic(model) #Temp, dew, Humi
ols_step_forward_aic(model) #wind, snow, rain
install.packages("HH"); library(HH)
ancova(Personal.Illness ~ total.snow + total.dew, data = data)
fit <- aov(Personal.Illness ~ total.snow + total.dew)
summary(fit) #dew만 유의미
fit <- aov(Personal.Illness ~ total.dew)
summary(fit) #dew만
plot(fit)
data$snow_YN <- data$total.snow
data$rain_YN <-replace(x<-data$rain_YN, x>0, 1)
data$snow_YN <-replace(x<-data$snow_YN, x>0, 1)
library(xlsx)
write.xlsx2(data, "C:\\Users\\TJ\\Documents\\Denver\\GitHub\\TheZoen\\CombinedData\\seoul_temp2.xlsx", sheetName="Sheet1",col.names=TRUE, row.names=FALSE)
write.csv(data, file = "seoul_temp2.csv", row.names = FALSE)
install.packages("HH")
